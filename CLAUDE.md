# Project Rules — ATM (Application for Technical Management)

## Package Manager

Используй **pnpm** во всём проекте.

---

## TypeScript Best Practices

### Core Principles

- Пиши лаконичный, технически точный TypeScript с примерами
- Используй функциональный и декларативный стиль; избегай классов (кроме NestJS backend)
- Предпочитай итерации и модуляризацию вместо дублирования кода
- Используй описательные имена с вспомогательными глаголами: `isLoading`, `hasError`, `canEdit`

### Naming Conventions

- **PascalCase** — классы, типы, интерфейсы
- **camelCase** — переменные, функции, методы
- **kebab-case** — файлы и директории (кроме компонентов React — PascalCase)
- **UPPERCASE** — переменные окружения и константы
- Функции начинаются с глагола; булевы значения с `is`, `has`, `can`

### TypeScript Usage

- TypeScript для всего кода; предпочитай `interface` вместо `type`
- Избегай `any`; создавай точные типы
- Избегай `enum`; используй `as const` maps
- Используй `readonly` для неизменяемых свойств

### Functions

- Короткие функции с одной целью (менее 20 строк)
- Стрелочные функции для простых операций (менее 3 строк)
- Именованные функции для сложной логики
- Early returns вместо вложенных блоков
- Default parameters вместо проверок на null/undefined
- RORO паттерн: "Receive an Object, Return an Object"

### Error Handling

- Исключения для неожиданных ошибок
- Логирование ошибок с контекстом
- Кастомные типы ошибок для консистентности
- Guard clauses для предусловий

---

## Documentation

Поддерживай следующие файлы документации:

- `/docs/changelog.md` — хронологический лог всех изменений
- `/docs/tasktracker.md` — статусы задач с описаниями
- `/docs/project.md` — общая архитектура и обзор проекта

### Changelog Format

```
## [YYYY-MM-DD] - Краткое описание

### Добавлено
- Новые функции

### Изменено
- Модификации

### Исправлено
- Баг-фиксы
```

### Tasktracker Format

```
## Task: [Название задачи]
- **Status**: [Not started/In progress/Completed]
- **Description**: [Детальное описание]
- **Steps**:
  - [x] Завершённый шаг
  - [ ] Текущий шаг
  - [ ] Запланированный шаг
- **Dependencies**: [Ссылки на другие задачи]
```

## Module Documentation (docs/)

Каждый модуль (feature, widget, entity, page, сложная утилита) должен иметь папку `docs/` с файлом `README.md`.

**Область применения:**

- Backend: `backend/src/modules/{moduleName}/docs/README.md`
- Frontend: любой слой FSD, где есть самостоятельный модуль:
  - `frontend/src/features/{featureName}/docs/README.md`
  - `frontend/src/widgets/{widgetName}/docs/README.md`
  - `frontend/src/entities/{entityName}/docs/README.md`
  - `frontend/src/pages/{pageName}/docs/README.md` (для сложных страниц)
  - `frontend/src/shared/{complexModule}/docs/README.md` (для сложных утилит, например `shared/api/`)

### Как работать с docs/

**При навигации по коду — сначала читай `docs/README.md` модуля.** Первые строки дают понимание: тот ли это модуль, туда ли мы полезли. Не доверяй контракту на слово, но используй как быструю навигацию.

**При изменении модуля — обнови `docs/README.md`.** Каждый раз, когда вносишь правки в модуль, актуализируй документацию. Устаревший контракт хуже, чем его отсутствие.

### Структура docs/README.md

```markdown
# {Название модуля}

{1-2 предложения: что делает модуль и зачем он нужен}

## Контракт модуля

### Назначение
{Подробное описание ответственности модуля}

### Public API
{Экспортируемые сущности: компоненты, хуки, типы, утилиты}

### Функциональные возможности
{Что модуль умеет делать — список возможностей}

### Использование
{Где и как модуль используется в проекте, примеры импорта}

### Внутренняя структура
{Директории и ключевые файлы}

### Зависимости
{От каких модулей зависит, какие модули зависят от него}

### Ограничения и TODO
{Известные ограничения, технический долг, запланированные улучшения}
```

## Development Process

- Перед каждым новым шагом — спроси подтверждение
- После каждого шага — краткое резюме (макс. 5 пунктов)
- В неоднозначных ситуациях — предложи 2-3 альтернативы
- Поддерживай контекст и общие цели проекта
- Периодически напоминай текущий статус и оставшиеся шаги
- Следуй архитектурным решениям из `/docs/project.md` и документации модулей
- Принципы: SOLID, KISS, DRY
- Удаляй неиспользуемый код и комментарии

## Code Documentation

JSDoc-блок для каждого нового файла:

```javascript
/**
 * @file: [filename]
 * @description: [краткое описание]
 * @dependencies: [связанные компоненты/файлы]
 * @created: [дата]
 */
```

## After Implementing New Functionality

Обновляй документацию в следующем порядке:
1. Обнови локальный `docs/README.md` модуля
2. Обнови `/docs/project.md` для крупных изменений
3. Обнови `/docs/changelog.md`
4. Обнови `/docs/tasktracker.md` если применимо

## Communication

- Задавай конкретные вопросы при неясных требованиях
- Объясняй плюсы/минусы при предложении альтернатив
- Предлагай декомпозицию крупных задач
- В конце сессии — краткий отчёт о прогрессе и следующие шаги
