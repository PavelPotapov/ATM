```md
---
description: Базовые правила FSD-архитектуры для фронтенда (React)
globs:
  - "frontend/src/**/*"
alwaysApply: true
---

Пакетный менеджер: pnpm

# Общие принципы

Ты работаешь во фронтенд-проекте с архитектурой Feature-Sliced Design (FSD) на React + TypeScript.
Строго соблюдай структуру слоёв, зависимостей между ними и публичный API слайсов.

## Слои и зависимости

Слои фронтенда:

- app/
- pages/
- widgets/
- features/
- entities/
- shared/

Правила зависимостей:

- app/ может использовать все слои.
- pages/ может использовать widgets/, features/, entities/, shared/.
- widgets/ может использовать features/, entities/, shared/.
- features/ может использовать entities/, shared/, а также при необходимости другие features/ только через их публичный API (импорты из index.ts или через слоты/props-композицию).
- entities/ может использовать только shared/.
- shared/ не может зависеть от других слоёв.

Не нарушай эти зависимости при импортах.

## Структура слайсов

В слоях widgets/, features/, entities/ каждый слайс должен иметь базовую структуру:

```
layer/
  sliceName/
    ui/      # React-компоненты и стили
    model/   # бизнес-логика, сторы, схемы, типы
    lib/     # вспомогательные функции
    api/     # запросы и мапперы (опционально)
    config/  # константы, фичефлаги (опционально)
    index.ts # публичный API слайса
```

Если создаёшь новый слайс, сначала создай эту структуру, даже если часть папок пока пустые.

## Публичный API слайсов

Внешний код должен импортировать сущности слайса только из его `index.ts`.

В `index.ts` экспортируй только публичный API: компоненты из ui/, хуки/сервисы из model/, утилиты из lib/.

```
// features/auth-login/index.ts
export { LoginForm } from './ui/LoginForm';
export { useLogin } from './model/useLogin';
```

Использование:

```
import { LoginForm } from '@/features/auth-login';
```

Не импортируй напрямую внутренние файлы слайса из других слайсов или слоёв.

## Импорты и alias

Используй alias:

- `@/app`
- `@/pages`
- `@/widgets`
- `@/features`
- `@/entities`
- `@/shared`

Правила:

- Не используй относительные импорты вида `../../../`, если можно использовать alias. Относительный импорт может быть максимум для двух вложенностей, то есть `../../` это ещё корректный импорт, все что больше - alias.
- Не импортируй код из слоёв, на которые текущий слой не должен зависеть (см. правила зависимостей).
- Для shared-утилит и общих компонентов используй пути типа `@/shared/ui/Button`, `@/shared/lib/date`.

## Компоненты и хуки

Используй только функциональные компоненты React.

Именование:

- компоненты — `PascalCase` (UserCard, LoginForm);
- хуки — с префиксом `use` (useLogin, useUserQuery).

Один основной компонент в одном файле.
Мелкие подкомпоненты, используемые только внутри одного файла, можно хранить рядом в том же файле.

## Именование файлов

**Правило именования файлов:**

- Для файлов с одним словом: используй `camelCase` (например: `utils.ts`, `config.ts`)
- Для файлов с несколькими словами: используй `camelCase` без дефисов (например: `axiosClient.ts`, `queryClient.ts`, `jwtTokenStorage.ts`)
- **Суффиксы через точку используются только когда контекст не ясен из папки** (опционально)

**Суффиксы (опционально, когда контекст не ясен):**

- **`.config.ts`** - Конфигурационные файлы (например: `endpoints.config.ts`, `routes.config.ts`)
- **`.dto.ts`** - Data Transfer Objects (например: `workspace.dto.ts`)
- **`.d.ts`** - Декларации типов TypeScript (например: `router.d.ts`, `global.d.ts`)

**Примеры правильного именования (контекст ясен из папки):**

- ✅ `LoginForm.tsx` (в `pages/login/ui/` или `shared/ui/` - компонент)
- ✅ `useWorkspaces.ts` (в `entities/workspaces/api/hooks/` - хук)
- ✅ `getWorkspaces.ts` (в `entities/workspaces/api/queries/` - query)
- ✅ `cn.ts` (в `shared/lib/utils/` - утилита)
- ✅ `axiosClient.ts` (в `shared/api/` - клиент)
- ✅ `jwtTokenStorage.ts` (в `shared/lib/storage/` - хранилище)
- ✅ `endpoints.config.ts` (в `shared/api/` - конфигурация, суффикс помогает различить)
- ✅ `workspace.dto.ts` (в `entities/workspaces/api/dto/` - DTO, суффикс помогает различить)

**Неправильные примеры:**
- ❌ `axios-client.ts` (дефис вместо camelCase)
- ❌ `query-client.ts` (дефис вместо camelCase)
- ❌ `jwt-token-storage.ts` (дефис вместо camelCase)
- ❌ `LoginForm.ts` (компонент должен быть `.tsx`)
- ❌ `useWorkspaces.tsx` (хуки должны быть `.ts`)

**Принцип:**
- Если файл находится в папке, которая явно указывает на его тип (`hooks/`, `queries/`, `utils/`, `ui/`, `storage/`, `api/`), суффикс не нужен
- Суффиксы используются для конфигураций (`.config.ts`), DTO (`.dto.ts`) и деклараций типов (`.d.ts`), когда нужно явно различить тип файла
- Главное - консистентность в рамках проекта

## Типы и модели

Типы доменных сущностей (User, Product и т.п.) хранятся в `entities/{entity}/model/`.

Общие, переиспользуемые типы без привязки к конкретной сущности — в `shared/` (например, `shared/lib/types/`).

Не дублируй типы между слоями — импортируй их из соответствующего entities/ или shared/.

## Общие UI и утилиты (shared)

Переиспользуемые UI-компоненты, не завязанные на конкретную фичу, кладутся в `shared/ui/` (Button, Input, Modal и т.п.).

Общие утилиты — в `shared/lib/` (форматирование дат, валидация, хелперы).

Общий API-слой (HTTP-клиент, базовые обёртки) — в `shared/api/`.

## Минимальные правила по коду

Код пишется на TypeScript в strict-режиме, избегай `any`, кроме крайних случаев.

Не смешивай бизнес-логику с представлением:

- работа с данными, сторы, запросы должны располагаться в `model/` и/или `api/`;
- компоненты в `ui/` должны получать подготовленные данные и коллбеки через props.

Старайся держать компоненты «тонкими», а логику — в хуках и model-слое.
```